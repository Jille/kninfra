#!/usr/bin/env python

import os
import os.path
import subprocess

from datetime import datetime

def main():
        name = datetime.now().strftime("%Y%m%d%H%M%S")
        os.chdir(os.path.expanduser("~/dumps"))
        os.mkdir(name)
        os.chdir(name)
        subprocess.call(['mongodump'])
        os.chdir('..')
        subprocess.call(['tar', 'cf', name+'.tar', name])
        subprocess.call(['rm', '-r', name])
        subprocess.call(['xz', '-9', name+'.tar'])

if __name__ == '__main__':
        main()
